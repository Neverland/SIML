/** SIML (c) 2013 James padolsey, http://github.com/padolsey/SIML **/
(function(){var l="undefined"!=typeof module&&module.exports?module.exports:window.siml={};(function(){"use strict";function n(l){return"[object Array]"==={}.toString.call(l)}function t(l){return(l+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;")}function u(l){return(l+"").replace(/^\s\s*|\s\s*$/g,"")}function e(l,n){for(var t in l)n.hasOwnProperty(t)||(n[t]=l[t]);return n}function r(l,n){return function(t,u,e,r){this.parentElement=e,this.indentation=r,t=[].slice.call(t);var o=t[0],f=u[l][o]||n[o];if(f||(f=u[l]._default||n._default),!f)throw Error("No fallback for"+t.join(""));this.type=f.type,this.html=f.make.apply(this,t)}}function o(l,n,t,u){this.spec=l,this.config=n||{},this.parentElement=t||this,this.indentation=u||"",this.defaultIndentation=n.indent,this.isPretty=n.pretty,this.output=[],this.content=[],this.attributes=[],this.selector=l[0],this.children=l[1]||[],this.make(),this.processChildren(),this.collectOutput(),this.html=this.output.join("")}function f(l){this.config=e(this.defaultConfig,l)}var s="div",i="  ",c={input:1,img:1,meta:1,link:1,br:1,hr:1,source:1,area:1,base:1,col:1},a={_fillText:{type:"CONTENT",make:function(l,n){return t(n)}},_default:{type:"CONTENT",make:function(l){throw Error("Directive not resolvable: "+l)}}},h={_default:{type:"ATTR",make:function(l,n){return l+'="'+t(n)+'"'}},text:{type:"CONTENT",make:function(l,n){return t(n)}}},p={_default:{type:"ATTR",make:function(l){return"input"===this.parentElement.tag?'type="'+l+'"':(console.warn("Unknown psuedo class used:",l),void 0)}}},A=/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/g,d=/#((?:[\w\u00c0-\uFFFF_-]|\\.)+)|$/,m=/\.((?:[\w\u00c0-\uFFFF_-]|\\.)+)(?![^[\]]+])/g,_=/^((?:[\w\u00c0-\uFFFF\*_-]|\\.)+)|$/,g=/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/g;o.prototype={make:function(){var l=this.selector,n=l.split(">");n.length>1&&(l=n.shift(),this.processElement(u(n.join(">")),this.children),this.children=[]);var t,e=l.match(_)[1]||s,r=l.match(m),o=l.match(d)[1];this.tag=e,this.isSingular=e in c,o&&this.attributes.push('id="'+o+'"'),r&&this.attributes.push('class="'+r.join(" ").replace(/(^| )\./g,"$1")+'"'),A.lastIndex=0,g.lastIndex=0;for(;t=A.exec(l);)this.processProperty("Attribute",[t[1],t[5]||t[4]]);for(;t=g.exec(l);)this.processProperty("Pseudo",[t[1],t[3]])},collectOutput:function(){var l=this.indentation,n=this.isPretty,t=this.output,u=this.attributes,e=this.content;return t.push(l+"<"+this.tag),t.push(u.length?" "+u.join(" "):""),this.isSingular?(t.push("/>"),void 0):(t.push(">"),e.length&&(n&&t.push("\n"),t.push(e.join(n?"\n":"")),n&&t.push("\n"+l)),t.push("</"+this.tag+">"),void 0)},processChildren:function(){for(var l=this.children,n=0,t=l.length;t>n;++n){var u=l[n][0];"Element"===u?this.processElement.apply(this,l[n][1]):this.processProperty(u,l[n][1])}},processElement:function(l,n){this.content.push(new f.Element([l,n],this.config,this,this.indentation+this.defaultIndentation).html)},processProperty:function(l,n){var t=new f[l](n,this.config,this,this.indentation+this.defaultIndentation);switch(t.type){case"ATTR":this.attributes.push(t.html);break;case"CONTENT":this.content.push(this.indentation+this.defaultIndentation+t.html)}}},f.escapeHTML=t,f.trim=u,f.isArray=n,f.Element=o,f.Attribute=r("attributes",h),f.Directive=r("directives",a),f.Pseudo=r("psuedos",p),f.prototype={defaultConfig:{pretty:!0,curly:!1,codeMatcher:null,indent:i,directives:{},attributes:{},psuedos:{}},parse:function(n,t){t=e(this.config,t||{}),t.pretty||(t.indent=""),t.curly&&(n+="\n/*siml:curly=true*/"),t.codeMatcher&&(!t.curly,n=this._tokenizeCode(n,t.codeMatcher));try{n=l.PARSER.parse(n)}catch(u){throw void 0!==u.line&&void 0!==u.column?new SyntaxError("SIML: Line "+u.line+", column "+u.column+": "+u.message):new SyntaxError("SIML: "+u.message)}for(var r=[],o=0,s=n.length;s>o;++o){var i=n[o][0];r[o]=new f[i](n[o][1],t).html}return this._deTokenizeCode(r.join(t.pretty?"\n":""))},_tokenizeCode:function(l,n){var t=this._codeTokens=[];return l.replace(RegExp(n,"g"),function(l){return'"____CODE_TOKEN_____'+(t.push(l)-1)+'"'})},_deTokenizeCode:function(l){if(!this._codeTokens)return l;var n=this._codeTokens;return l.replace(/____CODE_TOKEN_____(\d+)/g,function(l,t){return n[t]})}},l.Parser=f,l.defaultParser=new f({pretty:!0,indent:i}),l.parse=function(n,t){return l.defaultParser.parse(n,t)}})(),function(){var n={button:1,checkbox:1,color:1,date:1,datetime:1,"datetime-local":1,email:1,file:1,hidden:1,image:1,month:1,number:1,password:1,radio:1,range:1,reset:1,search:1,submit:1,tel:1,text:1,time:1,url:1,week:1};l.html5=new l.Parser({pretty:!0,indent:"	",directives:{doctype:{type:"CONTENT",make:function(){return"<!doctype html>"}}},psuedos:{_default:{type:"ATTR",make:function(l){if("input"===this.parentElement.tag&&l in n)return'type="'+l+'"';throw Error("Unknown Pseduo: "+l)}}}}),l.html5.INPUT_TYPES=n}(),l.angular=new l.Parser({pretty:!0,directives:{_default:{type:"ATTR",make:function(n,t){return n=n.replace(/([a-z])([A-Z])/g,function(l,n,t){return n+"-"+t.toLowerCase()}),n="$"===n.substring(0,1)?n.substring(1):"ng-"+n,n+'="'+l.Parser.escapeHTML(t)+'"'}}},psuedos:{_default:{type:"ATTR",make:function(n){return"input"===this.parentElement.tag&&n in l.html5.INPUT_TYPES?'type="'+n+'"':"ng-"+n.replace(/([a-z])([A-Z])/g,function(l,n,t){return n+"-"+t.toLowerCase()})}}}}),l.PARSER=function(){function l(l){return'"'+l.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var n={parse:function(n,t){function u(l){var n={};for(var t in l)n[t]=l[t];return n}function e(l,t){for(var u=l.offset+t,e=l.offset;u>e;e++){var r=n.charAt(e);"\n"===r?(l.seenCR||l.line++,l.column=1,l.seenCR=!1):"\r"===r||"\u2028"===r||"\u2029"===r?(l.line++,l.column=1,l.seenCR=!0):(l.column++,l.seenCR=!1)}l.offset+=t}function r(l){Z.offset<D.offset||(Z.offset>D.offset&&(D=u(Z),K=[]),K.push(l))}function o(){var l,n;return n=u(Z),l=f(),null!==l&&(l=function(l,n,t,u){return u}(n.offset,n.line,n.column,l)),null===l&&(Z=u(n)),l}function f(){var l,t,o,f,s,c,a;for(c=u(Z),l=[],a=u(Z),t=R(),null!==t?(o=i(),null!==o?(f=R(),null!==f?(59===n.charCodeAt(Z.offset)?(s=";",e(Z,1)):(s=null,0===I&&r('";"')),s=null!==s?s:"",null!==s?t=[t,o,f,s]:(t=null,Z=u(a))):(t=null,Z=u(a))):(t=null,Z=u(a))):(t=null,Z=u(a));null!==t;)l.push(t),a=u(Z),t=R(),null!==t?(o=i(),null!==o?(f=R(),null!==f?(59===n.charCodeAt(Z.offset)?(s=";",e(Z,1)):(s=null,0===I&&r('";"')),s=null!==s?s:"",null!==s?t=[t,o,f,s]:(t=null,Z=u(a))):(t=null,Z=u(a))):(t=null,Z=u(a))):(t=null,Z=u(a));return null!==l&&(l=function(l,n,t,u){for(var e=[],r=0;u.length>r;r++){var o=u[r][1][0],f=u[r][1][1];e.push([o,f])}return e}(c.offset,c.line,c.column,l)),null===l&&(Z=u(c)),l}function s(){var l,t,o,f,s,c,a;for(c=u(Z),l=[],a=u(Z),t=[],/^[\t ]/.test(n.charAt(Z.offset))?(o=n.charAt(Z.offset),e(Z,1)):(o=null,0===I&&r("[\\t ]"));null!==o;)t.push(o),/^[\t ]/.test(n.charAt(Z.offset))?(o=n.charAt(Z.offset),e(Z,1)):(o=null,0===I&&r("[\\t ]"));if(null!==t)if(o=i(),null!==o){for(f=[],/^[\t ]/.test(n.charAt(Z.offset))?(s=n.charAt(Z.offset),e(Z,1)):(s=null,0===I&&r("[\\t ]"));null!==s;)f.push(s),/^[\t ]/.test(n.charAt(Z.offset))?(s=n.charAt(Z.offset),e(Z,1)):(s=null,0===I&&r("[\\t ]"));null!==f?(59===n.charCodeAt(Z.offset)?(s=";",e(Z,1)):(s=null,0===I&&r('";"')),s=null!==s?s:"",null!==s?t=[t,o,f,s]:(t=null,Z=u(a))):(t=null,Z=u(a))}else t=null,Z=u(a);else t=null,Z=u(a);for(;null!==t;){for(l.push(t),a=u(Z),t=[],/^[\t ]/.test(n.charAt(Z.offset))?(o=n.charAt(Z.offset),e(Z,1)):(o=null,0===I&&r("[\\t ]"));null!==o;)t.push(o),/^[\t ]/.test(n.charAt(Z.offset))?(o=n.charAt(Z.offset),e(Z,1)):(o=null,0===I&&r("[\\t ]"));if(null!==t)if(o=i(),null!==o){for(f=[],/^[\t ]/.test(n.charAt(Z.offset))?(s=n.charAt(Z.offset),e(Z,1)):(s=null,0===I&&r("[\\t ]"));null!==s;)f.push(s),/^[\t ]/.test(n.charAt(Z.offset))?(s=n.charAt(Z.offset),e(Z,1)):(s=null,0===I&&r("[\\t ]"));null!==f?(59===n.charCodeAt(Z.offset)?(s=";",e(Z,1)):(s=null,0===I&&r('";"')),s=null!==s?s:"",null!==s?t=[t,o,f,s]:(t=null,Z=u(a))):(t=null,Z=u(a))}else t=null,Z=u(a);else t=null,Z=u(a)}return null!==l&&(l=function(l,n,t,u){for(var e=[],r=0;u.length>r;r++){var o=u[r][1][0],f=u[r][1][1];e.push([o,f])}return e}(c.offset,c.line,c.column,l)),null===l&&(Z=u(c)),l}function i(){var l,t,o,f,s,i,a,h,A;return h=u(Z),l=y(),null!==l&&(l=function(l,n,t,u){return["Directive",["_fillText",u]]}(h.offset,h.line,h.column,l)),null===l&&(Z=u(h)),null===l&&(h=u(Z),A=u(Z),l=g(),null!==l?(t=R(),null!==t?(58===n.charCodeAt(Z.offset)?(o=":",e(Z,1)):(o=null,0===I&&r('":"')),null!==o?(f=R(),null!==f?(s=C(),null!==s?(i=R(),null!==i?(59===n.charCodeAt(Z.offset)?(a=";",e(Z,1)):(a=null,0===I&&r('";"')),null!==a?l=[l,t,o,f,s,i,a]:(l=null,Z=u(A))):(l=null,Z=u(A))):(l=null,Z=u(A))):(l=null,Z=u(A))):(l=null,Z=u(A))):(l=null,Z=u(A))):(l=null,Z=u(A)),null!==l&&(l=function(l,n,t,u,e){return["Attribute",[u,e]]}(h.offset,h.line,h.column,l[0],l[4])),null===l&&(Z=u(h)),null===l&&(h=u(Z),l=c(),null!==l&&(l=function(l,n,t,u){return["Element",u]}(h.offset,h.line,h.column,l)),null===l&&(Z=u(h)),null===l&&(h=u(Z),A=u(Z),l=g(),null!==l?(t=R(),null!==t?(58===n.charCodeAt(Z.offset)?(o=":",e(Z,1)):(o=null,0===I&&r('":"')),null!==o?(f=R(),null!==f?(s=C(),null!==s?l=[l,t,o,f,s]:(l=null,Z=u(A))):(l=null,Z=u(A))):(l=null,Z=u(A))):(l=null,Z=u(A))):(l=null,Z=u(A)),null!==l&&(l=function(l,n,t,u,e){return["Attribute",[u,e]]}(h.offset,h.line,h.column,l[0],l[4])),null===l&&(Z=u(h)),null===l&&(h=u(Z),l=p(),null!==l&&(l=function(l,n,t,u){return["Directive",u]}(h.offset,h.line,h.column,l)),null===l&&(Z=u(h)))))),l}function c(){var l,t,o,i,c,h,A,d,m,_,g;if(I++,_=u(Z),g=u(Z),l=a(),null!==l?(123===n.charCodeAt(Z.offset)?(t="{",e(Z,1)):(t=null,0===I&&r('"{"')),null!==t?(o=R(),null!==o?(125===n.charCodeAt(Z.offset)?(i="}",e(Z,1)):(i=null,0===I&&r('"}"')),null!==i?l=[l,t,o,i]:(l=null,Z=u(g))):(l=null,Z=u(g))):(l=null,Z=u(g))):(l=null,Z=u(g)),null!==l&&(l=function(l,n,t,u){return[u]}(_.offset,_.line,_.column,l[0])),null===l&&(Z=u(_)),null===l&&(_=u(Z),g=u(Z),l=a(),null!==l?(t=R(),null!==t?(123===n.charCodeAt(Z.offset)?(o="{",e(Z,1)):(o=null,0===I&&r('"{"')),null!==o?(i=R(),null!==i?(c=f(),null!==c?(h=R(),null!==h?(125===n.charCodeAt(Z.offset)?(A="}",e(Z,1)):(A=null,0===I&&r('"}"')),null!==A?l=[l,t,o,i,c,h,A]:(l=null,Z=u(g))):(l=null,Z=u(g))):(l=null,Z=u(g))):(l=null,Z=u(g))):(l=null,Z=u(g))):(l=null,Z=u(g))):(l=null,Z=u(g)),null!==l&&(l=function(l,n,t,u,e){return[u,e]}(_.offset,_.line,_.column,l[0],l[4])),null===l&&(Z=u(_)),null===l)){if(_=u(Z),g=u(Z),l=a(),null!==l){for(t=[],/^[\t ]/.test(n.charAt(Z.offset))?(o=n.charAt(Z.offset),e(Z,1)):(o=null,0===I&&r("[\\t ]"));null!==o;)t.push(o),/^[\t ]/.test(n.charAt(Z.offset))?(o=n.charAt(Z.offset),e(Z,1)):(o=null,0===I&&r("[\\t ]"));null!==t?(o=y(),null!==o?(i=R(),null!==i?(123===n.charCodeAt(Z.offset)?(c="{",e(Z,1)):(c=null,0===I&&r('"{"')),null!==c?(h=R(),null!==h?(A=f(),null!==A?(d=R(),null!==d?(125===n.charCodeAt(Z.offset)?(m="}",e(Z,1)):(m=null,0===I&&r('"}"')),null!==m?l=[l,t,o,i,c,h,A,d,m]:(l=null,Z=u(g))):(l=null,Z=u(g))):(l=null,Z=u(g))):(l=null,Z=u(g))):(l=null,Z=u(g))):(l=null,Z=u(g))):(l=null,Z=u(g))):(l=null,Z=u(g))}else l=null,Z=u(g);if(null!==l&&(l=function(l,n,t,u,e,r){return r.unshift(["Attribute",["text",e]]),[u,r]}(_.offset,_.line,_.column,l[0],l[2],l[6])),null===l&&(Z=u(_)),null===l){if(_=u(Z),g=u(Z),l=a(),null!==l){if(/^[\t ]/.test(n.charAt(Z.offset))?(o=n.charAt(Z.offset),e(Z,1)):(o=null,0===I&&r("[\\t ]")),null!==o)for(t=[];null!==o;)t.push(o),/^[\t ]/.test(n.charAt(Z.offset))?(o=n.charAt(Z.offset),e(Z,1)):(o=null,0===I&&r("[\\t ]"));else t=null;null!==t?(o=s(),null!==o?l=[l,t,o]:(l=null,Z=u(g))):(l=null,Z=u(g))}else l=null,Z=u(g);if(null!==l&&(l=function(l,n,t,u,e){return[u,e]}(_.offset,_.line,_.column,l[0],l[2])),null===l&&(Z=u(_)),null===l){if(_=u(Z),g=u(Z),l=a(),null!==l){for(t=[],/^[\t ]/.test(n.charAt(Z.offset))?(o=n.charAt(Z.offset),e(Z,1)):(o=null,0===I&&r("[\\t ]"));null!==o;)t.push(o),/^[\t ]/.test(n.charAt(Z.offset))?(o=n.charAt(Z.offset),e(Z,1)):(o=null,0===I&&r("[\\t ]"));null!==t?(o=y(),null!==o?l=[l,t,o]:(l=null,Z=u(g))):(l=null,Z=u(g))}else l=null,Z=u(g);if(null!==l&&(l=function(l,n,t,u,e){return[u,[["Attribute",["text",e]]]]}(_.offset,_.line,_.column,l[0],l[2])),null===l&&(Z=u(_)),null===l){if(_=u(Z),g=u(Z),l=a(),null!==l){for(t=[],/^[\t ]/.test(n.charAt(Z.offset))?(o=n.charAt(Z.offset),e(Z,1)):(o=null,0===I&&r("[\\t ]"));null!==o;)t.push(o),/^[\t ]/.test(n.charAt(Z.offset))?(o=n.charAt(Z.offset),e(Z,1)):(o=null,0===I&&r("[\\t ]"));null!==t?(o=p(),null!==o?l=[l,t,o]:(l=null,Z=u(g))):(l=null,Z=u(g))}else l=null,Z=u(g);null!==l&&(l=function(l,n,t,u,e){return[u,[["Directive",e]]]}(_.offset,_.line,_.column,l[0],l[2])),null===l&&(Z=u(_)),null===l&&(_=u(Z),l=a(),null!==l&&(l=function(l,n,t,u){return[u]}(_.offset,_.line,_.column,l)),null===l&&(Z=u(_)))}}}}return I--,0===I&&null===l&&r("Element"),l}function a(){var l,t,o,f,s,i,c,a,p;if(I++,c=u(Z),a=u(Z),l=h(),null!==l){for(t=[],p=u(Z),o=R(),null!==o?(62===n.charCodeAt(Z.offset)?(f=">",e(Z,1)):(f=null,0===I&&r('">"')),null!==f?(s=R(),null!==s?(i=h(),null!==i?o=[o,f,s,i]:(o=null,Z=u(p))):(o=null,Z=u(p))):(o=null,Z=u(p))):(o=null,Z=u(p));null!==o;)t.push(o),p=u(Z),o=R(),null!==o?(62===n.charCodeAt(Z.offset)?(f=">",e(Z,1)):(f=null,0===I&&r('">"')),null!==f?(s=R(),null!==s?(i=h(),null!==i?o=[o,f,s,i]:(o=null,Z=u(p))):(o=null,Z=u(p))):(o=null,Z=u(p))):(o=null,Z=u(p));null!==t?l=[l,t]:(l=null,Z=u(a))}else l=null,Z=u(a);return null!==l&&(l=function(l,n,t,u){var e=u.join("").replace(/,/g,"").replace(/____STRING_TOKEN_____[0-9]+/g,function(l){return'"'+P(l).replace(/\\"/g,'"').replace(/"/g,'\\"')+'"'}).replace(/[\r\n]+/g,"");return e}(c.offset,c.line,c.column,l)),null===l&&(Z=u(c)),I--,0===I&&null===l&&r("Selector"),l}function h(){var l,t,o,f,s;if(o=u(Z),f=u(Z),s=u(Z),/^[^{}<>\n\t ]/.test(n.charAt(Z.offset))?(t=n.charAt(Z.offset),e(Z,1)):(t=null,0===I&&r("[^{}<>\\n\\t ]")),null!==t)for(l=[];null!==t;)l.push(t),/^[^{}<>\n\t ]/.test(n.charAt(Z.offset))?(t=n.charAt(Z.offset),e(Z,1)):(t=null,0===I&&r("[^{}<>\\n\\t ]"));else l=null;return null!==l?(" :"===n.substr(Z.offset,2)?(t=" :",e(Z,2)):(t=null,0===I&&r('" :"')),t=null!==t?t:"",null!==t?l=[l,t]:(l=null,Z=u(s))):(l=null,Z=u(s)),null!==l?(t=function(l,n,t,u){return u=u[0].join("")+u[1],/^(?:[a-z0-9-_]|[#.][a-z0-9-_$]|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|:[a-z][a-z0-9]*)+\s*$/i.test(u)}(Z.offset,Z.line,Z.column,l)?"":null,null!==t?l=[l,t]:(l=null,Z=u(f))):(l=null,Z=u(f)),null!==l&&(l=function(l,n,t,u){return u.join("")}(o.offset,o.line,o.column,l[0])),null===l&&(Z=u(o)),l}function p(){var l,t,o,f,s,i;return I++,s=u(Z),i=u(Z),l=A(),null!==l?(40===n.charCodeAt(Z.offset)?(t="(",e(Z,1)):(t=null,0===I&&r('"("')),null!==t?(41===n.charCodeAt(Z.offset)?(o=")",e(Z,1)):(o=null,0===I&&r('")"')),null!==o?l=[l,t,o]:(l=null,Z=u(i))):(l=null,Z=u(i))):(l=null,Z=u(i)),null!==l&&(l=function(l,n,t,u){return[u]}(s.offset,s.line,s.column,l[0])),null===l&&(Z=u(s)),null===l&&(s=u(Z),i=u(Z),l=A(),null!==l?(40===n.charCodeAt(Z.offset)?(t="(",e(Z,1)):(t=null,0===I&&r('"("')),null!==t?(o=v(),null!==o?(41===n.charCodeAt(Z.offset)?(f=")",e(Z,1)):(f=null,0===I&&r('")"')),null!==f?l=[l,t,o,f]:(l=null,Z=u(i))):(l=null,Z=u(i))):(l=null,Z=u(i))):(l=null,Z=u(i)),null!==l&&(l=function(l,n,t,u,e){return[u,e]}(s.offset,s.line,s.column,l[0],l[2])),null===l&&(Z=u(s)),null===l&&(s=u(Z),i=u(Z),l=A(),null!==l?(t=d(),null!==t?l=[l,t]:(l=null,Z=u(i))):(l=null,Z=u(i)),null!==l&&(l=function(l,n,t,u,e){return[u,[e.substr(1,e.length-2).replace(/[\s\r\n]+/g," ").replace(/^\s\s*|\s\s*$/g,"")]]}(s.offset,s.line,s.column,l[0],l[1])),null===l&&(Z=u(s)))),I--,0===I&&null===l&&r("Directive"),l}function A(){var l,t,o,f,s;if(I++,f=u(Z),s=u(Z),/^[a-zA-Z_$]/.test(n.charAt(Z.offset))?(l=n.charAt(Z.offset),e(Z,1)):(l=null,0===I&&r("[a-zA-Z_$]")),null!==l){for(t=[],/^[a-zA-Z0-9$_]/.test(n.charAt(Z.offset))?(o=n.charAt(Z.offset),e(Z,1)):(o=null,0===I&&r("[a-zA-Z0-9$_]"));null!==o;)t.push(o),/^[a-zA-Z0-9$_]/.test(n.charAt(Z.offset))?(o=n.charAt(Z.offset),e(Z,1)):(o=null,0===I&&r("[a-zA-Z0-9$_]"));null!==t?l=[l,t]:(l=null,Z=u(s))}else l=null,Z=u(s);return null!==l&&(l=function(l,n,t,u,e){return u+e.join("")}(f.offset,f.line,f.column,l[0],l[1])),null===l&&(Z=u(f)),I--,0===I&&null===l&&r("DirectiveName"),l}function d(){var l,t,o,f,s;if(f=u(Z),s=u(Z),40===n.charCodeAt(Z.offset)?(l="(",e(Z,1)):(l=null,0===I&&r('"("')),null!==l){for(t=[],o=d(),null===o&&(o=_());null!==o;)t.push(o),o=d(),null===o&&(o=_());null!==t?(41===n.charCodeAt(Z.offset)?(o=")",e(Z,1)):(o=null,0===I&&r('")"')),null!==o?l=[l,t,o]:(l=null,Z=u(s))):(l=null,Z=u(s))}else l=null,Z=u(s);return null!==l&&(l=function(l,n,t,u){return"("+u.join("")+")"}(f.offset,f.line,f.column,l[1])),null===l&&(Z=u(f)),l}function m(){var l,n,t;if(t=u(Z),n=_(),null!==n)for(l=[];null!==n;)l.push(n),n=_();else l=null;return null!==l&&(l=function(l,n,t,u){return u.join("")}(t.offset,t.line,t.column,l)),null===l&&(Z=u(t)),l}function _(){var l;return/^[^()]/.test(n.charAt(Z.offset))?(l=n.charAt(Z.offset),e(Z,1)):(l=null,0===I&&r("[^()]")),l}function g(){var l,t,o;if(I++,o=u(Z),/^[A-Za-z0-9\-_]/.test(n.charAt(Z.offset))?(t=n.charAt(Z.offset),e(Z,1)):(t=null,0===I&&r("[A-Za-z0-9\\-_]")),null!==t)for(l=[];null!==t;)l.push(t),/^[A-Za-z0-9\-_]/.test(n.charAt(Z.offset))?(t=n.charAt(Z.offset),e(Z,1)):(t=null,0===I&&r("[A-Za-z0-9\\-_]"));else l=null;return null!==l&&(l=function(l,n,t,u){return u.join("")}(o.offset,o.line,o.column,l)),null===l&&(Z=u(o)),null===l&&(l=y()),I--,0===I&&null===l&&r("AttributeName"),l}function v(){var l,t,o,f,s,i,c,a;if(i=u(Z),c=u(Z),l=C(),null!==l){for(t=[],a=u(Z),44===n.charCodeAt(Z.offset)?(o=",",e(Z,1)):(o=null,0===I&&r('","')),null!==o?(f=R(),null!==f?(s=C(),null!==s?o=[o,f,s]:(o=null,Z=u(a))):(o=null,Z=u(a))):(o=null,Z=u(a));null!==o;)t.push(o),a=u(Z),44===n.charCodeAt(Z.offset)?(o=",",e(Z,1)):(o=null,0===I&&r('","')),null!==o?(f=R(),null!==f?(s=C(),null!==s?o=[o,f,s]:(o=null,Z=u(a))):(o=null,Z=u(a))):(o=null,Z=u(a));null!==t?l=[l,t]:(l=null,Z=u(c))}else l=null,Z=u(c);return null!==l&&(l=function(l,n,t,u,e){for(var r=[u],o=0;e.length>o;o++)r.push(e[o][2]);return r}(i.offset,i.line,i.column,l[0],l[1])),null===l&&(Z=u(i)),l}function C(){var l,t,o,f;return l=y(),null===l&&(l=E(),null===l&&(l=T(),null===l&&(o=u(Z),f=u(Z),"true"===n.substr(Z.offset,4)?(l="true",e(Z,4)):(l=null,0===I&&r('"true"')),null!==l?(t=R(),null!==t?l=[l,t]:(l=null,Z=u(f))):(l=null,Z=u(f)),null!==l&&(l=function(){return!0}(o.offset,o.line,o.column)),null===l&&(Z=u(o)),null===l&&(o=u(Z),f=u(Z),"false"===n.substr(Z.offset,5)?(l="false",e(Z,5)):(l=null,0===I&&r('"false"')),null!==l?(t=R(),null!==t?l=[l,t]:(l=null,Z=u(f))):(l=null,Z=u(f)),null!==l&&(l=function(){return!1}(o.offset,o.line,o.column)),null===l&&(Z=u(o)))))),l}function y(){var l,t,o,f,s;if(I++,f=u(Z),s=u(Z),"____STRING_TOKEN_____"===n.substr(Z.offset,21)?(l="____STRING_TOKEN_____",e(Z,21)):(l=null,0===I&&r('"____STRING_TOKEN_____"')),null!==l){if(/^[0-9]/.test(n.charAt(Z.offset))?(o=n.charAt(Z.offset),e(Z,1)):(o=null,0===I&&r("[0-9]")),null!==o)for(t=[];null!==o;)t.push(o),/^[0-9]/.test(n.charAt(Z.offset))?(o=n.charAt(Z.offset),e(Z,1)):(o=null,0===I&&r("[0-9]"));else t=null;null!==t?l=[l,t]:(l=null,Z=u(s))}else l=null,Z=u(s);return null!==l&&(l=function(l,n,t,u){return M[u.join("")]}(f.offset,f.line,f.column,l[1])),null===l&&(Z=u(f)),I--,0===I&&null===l&&r("String"),l}function E(){var l,t,o;if(I++,o=u(Z),/^[a-zA-Z0-9$@#]/.test(n.charAt(Z.offset))?(t=n.charAt(Z.offset),e(Z,1)):(t=null,0===I&&r("[a-zA-Z0-9$@#]")),null!==t)for(l=[];null!==t;)l.push(t),/^[a-zA-Z0-9$@#]/.test(n.charAt(Z.offset))?(t=n.charAt(Z.offset),e(Z,1)):(t=null,0===I&&r("[a-zA-Z0-9$@#]"));else l=null;return null!==l&&(l=function(l,n,t,u){return u.join("")}(o.offset,o.line,o.column,l)),null===l&&(Z=u(o)),I--,0===I&&null===l&&r("SimpleString"),l}function T(){var l,n,t,e,o,f;return I++,o=u(Z),f=u(Z),l=b(),null!==l?(n=F(),null!==n?(t=x(),null!==t?(e=R(),null!==e?l=[l,n,t,e]:(l=null,Z=u(f))):(l=null,Z=u(f))):(l=null,Z=u(f))):(l=null,Z=u(f)),null!==l&&(l=function(l,n,t,u,e,r){return parseFloat(u+e+r)}(o.offset,o.line,o.column,l[0],l[1],l[2])),null===l&&(Z=u(o)),null===l&&(o=u(Z),f=u(Z),l=b(),null!==l?(n=F(),null!==n?(t=R(),null!==t?l=[l,n,t]:(l=null,Z=u(f))):(l=null,Z=u(f))):(l=null,Z=u(f)),null!==l&&(l=function(l,n,t,u,e){return parseFloat(u+e)}(o.offset,o.line,o.column,l[0],l[1])),null===l&&(Z=u(o)),null===l&&(o=u(Z),f=u(Z),l=b(),null!==l?(n=x(),null!==n?(t=R(),null!==t?l=[l,n,t]:(l=null,Z=u(f))):(l=null,Z=u(f))):(l=null,Z=u(f)),null!==l&&(l=function(l,n,t,u,e){return parseFloat(u+e)}(o.offset,o.line,o.column,l[0],l[1])),null===l&&(Z=u(o)),null===l&&(o=u(Z),f=u(Z),l=b(),null!==l?(n=R(),null!==n?l=[l,n]:(l=null,Z=u(f))):(l=null,Z=u(f)),null!==l&&(l=function(l,n,t,u){return parseFloat(u)}(o.offset,o.line,o.column,l[0])),null===l&&(Z=u(o))))),I--,0===I&&null===l&&r("number"),l}function b(){var l,t,o,f,s;return f=u(Z),s=u(Z),l=k(),null!==l?(t=w(),null!==t?l=[l,t]:(l=null,Z=u(s))):(l=null,Z=u(s)),null!==l&&(l=function(l,n,t,u,e){return u+e}(f.offset,f.line,f.column,l[0],l[1])),null===l&&(Z=u(f)),null===l&&(l=N(),null===l&&(f=u(Z),s=u(Z),45===n.charCodeAt(Z.offset)?(l="-",e(Z,1)):(l=null,0===I&&r('"-"')),null!==l?(t=k(),null!==t?(o=w(),null!==o?l=[l,t,o]:(l=null,Z=u(s))):(l=null,Z=u(s))):(l=null,Z=u(s)),null!==l&&(l=function(l,n,t,u,e){return"-"+u+e}(f.offset,f.line,f.column,l[1],l[2])),null===l&&(Z=u(f)),null===l&&(f=u(Z),s=u(Z),45===n.charCodeAt(Z.offset)?(l="-",e(Z,1)):(l=null,0===I&&r('"-"')),null!==l?(t=N(),null!==t?l=[l,t]:(l=null,Z=u(s))):(l=null,Z=u(s)),null!==l&&(l=function(l,n,t,u){return"-"+u}(f.offset,f.line,f.column,l[1])),null===l&&(Z=u(f))))),l}function F(){var l,t,o,f;return o=u(Z),f=u(Z),46===n.charCodeAt(Z.offset)?(l=".",e(Z,1)):(l=null,0===I&&r('"."')),null!==l?(t=w(),null!==t?l=[l,t]:(l=null,Z=u(f))):(l=null,Z=u(f)),null!==l&&(l=function(l,n,t,u){return"."+u}(o.offset,o.line,o.column,l[1])),null===l&&(Z=u(o)),l}function x(){var l,n,t,e;return t=u(Z),e=u(Z),l=S(),null!==l?(n=w(),null!==n?l=[l,n]:(l=null,Z=u(e))):(l=null,Z=u(e)),null!==l&&(l=function(l,n,t,u,e){return u+e}(t.offset,t.line,t.column,l[0],l[1])),null===l&&(Z=u(t)),l}function w(){var l,n,t;if(t=u(Z),n=N(),null!==n)for(l=[];null!==n;)l.push(n),n=N();else l=null;return null!==l&&(l=function(l,n,t,u){return u.join("")}(t.offset,t.line,t.column,l)),null===l&&(Z=u(t)),l}function S(){var l,t,o,f;return o=u(Z),f=u(Z),/^[eE]/.test(n.charAt(Z.offset))?(l=n.charAt(Z.offset),e(Z,1)):(l=null,0===I&&r("[eE]")),null!==l?(/^[+\-]/.test(n.charAt(Z.offset))?(t=n.charAt(Z.offset),e(Z,1)):(t=null,0===I&&r("[+\\-]")),t=null!==t?t:"",null!==t?l=[l,t]:(l=null,Z=u(f))):(l=null,Z=u(f)),null!==l&&(l=function(l,n,t,u,e){return u+e}(o.offset,o.line,o.column,l[0],l[1])),null===l&&(Z=u(o)),l}function N(){var l;return/^[0-9]/.test(n.charAt(Z.offset))?(l=n.charAt(Z.offset),e(Z,1)):(l=null,0===I&&r("[0-9]")),l}function k(){var l;return/^[1-9]/.test(n.charAt(Z.offset))?(l=n.charAt(Z.offset),e(Z,1)):(l=null,0===I&&r("[1-9]")),l}function z(){var l;return/^[0-9a-fA-F]/.test(n.charAt(Z.offset))?(l=n.charAt(Z.offset),e(Z,1)):(l=null,0===I&&r("[0-9a-fA-F]")),l}function R(){var l,n;for(I++,l=[],n=j();null!==n;)l.push(n),n=j();return I--,0===I&&null===l&&r("whitespace"),l}function j(){var l;return/^[ \t\n\r]/.test(n.charAt(Z.offset))?(l=n.charAt(Z.offset),e(Z,1)):(l=null,0===I&&r("[ \\t\\n\\r]")),l}function $(l){l.sort();for(var n=null,t=[],u=0;l.length>u;u++)l[u]!==n&&(t.push(l[u]),n=l[u]);return t}function P(l){return M[l.substring("____STRING_TOKEN_____".length)]}var O={start:o,children:f,singleLineChildren:s,child:i,element:c,selector:a,singleSelector:h,directive:p,directiveName:A,braced:d,nonBraceCharacters:m,nonBraceCharacter:_,attributeName:g,arrayElements:v,value:C,string:y,simpleString:E,number:T,"int":b,frac:F,exp:x,digits:w,e:S,digit:N,digit19:k,hexDigit:z,_:R,whitespace:j};if(void 0!==t){if(void 0===O[t])throw Error("Invalid rule name: "+l(t)+".")}else t="start";var Z={offset:0,line:1,column:1,seenCR:!1},I=0,D={offset:0,line:1,column:1,seenCR:!1},K=[],M=[];n=n.replace(/(["'])((?:\\\1|[^\1])*?)\1/g,function(l,n,t){return"____STRING_TOKEN_____"+(M.push(t.replace(/\\'/g,"'").replace(/\\"/g,'"'))-1)});var L=/\/\*\s*siml:curly=true\s*\*\//i.test(n);n=n.replace(/\/\*[\s\S]*?\*\//g,""),n=n.replace(/\/\/.+?(?=[\r\n])/g,""),function(){if(!L){n=n.replace(/^(?:\s*\n)+/g,"");var l,t=0,u=[],e=null;n=n.split(/[\r\n]+/);for(var r=0,o=n.length;o>r;++r){var f=n[r],s=f.match(/^\s*/)[0],i=(s.match(/\s/g)||[]).length,c=((n[r+1]||"").match(/^\s*/)[0].match(/\s/g)||[]).length;if(null==e&&(e=c-i),/^\s+$/.test(f))u.push(f);else if(/^\s*[A-Za-z0-9-_#.]+\s*(?:>\s*[A-Za-z0-9-_#.]+)*/.test(f))if(/[{}]\s*$/.test(f))u.push(f);else{if(f=f.substring(s.length),l>i)for(var a=l-i;;){if(a-=e,0===t||0>a)break;t--,u[r-1]+="}"}c>i?(t++,u.push(s+f+"{")):u.push(s+f),l=i}else l=i,u.push(f)}n=u.join("\n"),n+=Array(t+1).join("}")}}();var G=O[t]();if(null===G||Z.offset!==n.length){var B=Math.max(Z.offset,D.offset),U=n.length>B?n.charAt(B):null,H=Z.offset>D.offset?Z:D;throw new this.SyntaxError($(K),U,B,H.line,H.column)}return G},toSource:function(){return this._source}};return n.SyntaxError=function(n,t,u,e,r){function o(n,t){var u,e;switch(n.length){case 0:u="end of input";break;case 1:u=n[0];break;default:u=n.slice(0,n.length-1).join(", ")+" or "+n[n.length-1]}return e=t?l(t):"end of input","Expected "+u+" but "+e+" found."}this.name="SyntaxError",this.expected=n,this.found=t,this.message=o(n,t),this.offset=u,this.line=e,this.column=r},n.SyntaxError.prototype=Error.prototype,n}()})();