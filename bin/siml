#!/usr/bin/env node

var siml = require('../dist/siml.all');
var fs = require('fs');
var program = require('commander');

program
	.version('0.2.0')
	.usage('[options] [file]')
	.option('-m, --mode <str>', '"default" or "angular"');

program.parse(process.argv);

var parser = siml.defaultParser;

if (program.mode && program.mode !== 'default') {
	switch (program.mode) {
		case 'angular':
			parser = siml.angular;
			break;
		case 'html5':
			parser = siml.html5;
		//...
	}
}

if (process.stdin.fd) {
	var size = fs.fstatSync(process.stdin.fd).size;
	var buffer = size > 0 ? fs.readSync(process.stdin.fd, size)[0] : '';
}

process.stdout.write(
	parser.parse( buffer || program.args[0] ) + '\n'
);